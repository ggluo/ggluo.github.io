<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Generative Image Priors for MRI Reconstruction Trained from Magnitude-Only Images | Guanxiong Jason Luo</title> <meta name="author" content="Guanxiong Jason Luo"> <meta name="description" content="generative pretraining, image priors, diffusion models, inverse problem, MR image reconstruction, proximal operator, optimization"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%90%86&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://ggluo.github.io/projects/1_project/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">GuanxiongÂ Luo</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Generative Image Priors for MRI Reconstruction Trained from Magnitude-Only Images</h1> <p class="post-description">generative pretraining, image priors, diffusion models, inverse problem, MR image reconstruction, proximal operator, optimization</p> </header> <article> <div style="float: right; margin-left: 1rem; margin-bottom: 0rem"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 1000px)" srcset="/assets/img/projects/image_priors/image_priors-1000.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1200px)" srcset="/assets/img/projects/image_priors/image_priors-1200.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/projects/image_priors/image_priors-1400.webp"></source> <img src="/assets/img/projects/image_priors/image_priors.png" class="img-fluid rounded z-depth-1" width="400" height="auto" title="overview" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption_post"> Figure 1. Overview of the proposed method. </div> </div> <p><strong><code class="language-plaintext highlighter-rouge">Abstract</code></strong> In this work, we present a workflow to construct generic and robust generative image priors from magnitude-only images. The priors can then be used for regularization in reconstruction to improve image quality. The workflow begins with the preparation of training datasets from magnitude-only MR images. This dataset is then augmented with phase information and used to train generative priors of complex images. Finally, trained priors are evaluated using both linear and nonlinear reconstruction for compressed sensing parallel imaging with various undersampling schemes. The results of our experiments demonstrate that priors trained on complex images outperform priors trained only on magnitude images. Additionally, a prior trained on a larger dataset exhibits higher robustness. Finally, we show that the generative priors are superior to L\(^\mathrm{1}\)-wavelet regularization for compressed sensing parallel imaging with high undersampling.</p> <p><strong><code class="language-plaintext highlighter-rouge">TLDR</code></strong> These findings stress the importance of incorporating phase information and leveraging large datasets to raise the performance and reliability of the generative priors for MRI reconstruction. Phase augmentation makes it possible to use existing image databases for training.</p> <p>We leverage a diffusion model trained on a small dataset (1000 images) of complex images to augment a much larger dataset (~80k images) for which the phase information of the image is not available.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 1000px)" srcset="/assets/img/projects/image_priors/phase_aug-1000.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1200px)" srcset="/assets/img/projects/image_priors/phase_aug-1200.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/projects/image_priors/phase_aug-1400.webp"></source> <img src="/assets/img/projects/image_priors/phase_aug.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="MMSE vs MAP" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption_post" style="margin-bottom: 1.15rem"> Human brain images of different quality are shown (rows). On the left, the original magnitude-only images are compared to the magnitude of a corresponding image generated using phase augmentation. On the right, the phase maps of three different generated images are shown. </div> </div> <p>In total, we trained six priors in this work with a small phase-preserved dataset and phase-augmented images using the full ABIDE dataset with 1206 volumes. The information about computational resources used to train the six different priors is listed in below table.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 1000px)" srcset="/assets/img/projects/image_priors/priors_table-1000.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1200px)" srcset="/assets/img/projects/image_priors/priors_table-1200.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/projects/image_priors/priors_table-1400.webp"></source> <img src="/assets/img/projects/image_priors/priors_table.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="MMSE vs MAP" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>Comparison of images reconstructed using PICS using the priors \(\texttt{P}_\mathrm{SM},~\texttt{P}_\mathrm{LM},~\texttt{P}_\mathrm{SC},~\texttt{P}_\mathrm{LC},~\texttt{D}_\mathrm{SC}\) in comparison to an \(\ell_1\)-wavelet reconstruction and a reference. The top two rows (1D) present the results for 5-fold acceleration along phase-encoding direction with 30 calibration lines. The bottom two rows (Poisson) show the results using a Poisson-disc acquisition of 8.2x-undersampling. PSNR and SSIM values are shown in white text.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 1000px)" srcset="/assets/img/projects/image_priors/pics-1000.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1200px)" srcset="/assets/img/projects/image_priors/pics-1200.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/projects/image_priors/pics-1400.webp"></source> <img src="/assets/img/projects/image_priors/pics.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="MMSE vs MAP" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p><strong><code class="language-plaintext highlighter-rouge">Conclusion</code></strong>This work focuses on how to extract prior knowledge from existing magnitude-only image datasets using phase augmentation with generative models. The extracted prior knowledge is then applied as regularization in image reconstruction. The effectiveness of this approach in improving image quality is systematically evaluated across different settings. Our findings stress the importance of incorporating phase information and leveraging large datasets to raise performance and reliability of generative priors for MRI reconstruction.</p> </article> <h2>References</h2> <div class="publications"> <h2 class="bibliography">2023</h2> <ol class="bibliography"><li> <div class="row"> <div class="col-sm-2 abbr"><abbr class="badge">arXiv</abbr></div> <div id="luo2023generative" class="col-sm-8"> <div class="title">Generative Image Priors for MRI Reconstruction Trained from Magnitude-Only Images</div> <div class="author"> <em>Guanxiong Luo</em>,Â Xiaoqing Wang,Â Mortiz Blumenthal,Â Martin Schilling,Â Erik Hans Ulrich Rauf, and <span class="more-authors" title="click to view 3 more authors" onclick=" var element=$(this); element.attr('title', ''); var more_authors_text=element.text() == '3 more authors' ? 'Raviteja Kotikalapudi, Niels Focke, Martin Uecker' : '3 more authors'; var cursorPosition=0; var textAdder=setInterval(function(){ element.text(more_authors_text.substring(0, cursorPosition + 1)); if (++cursorPosition == more_authors_text.length){ clearInterval(textAdder); } }, '10'); ">3 more authors</span> </div> <div class="periodical"> Aug 2023 </div> <div class="periodical"> </div> <div class="links"> <a href="/assets/pdf/2308.02340.pdf" class="btn btn-sm z-depth-0" role="button">PDF</a> <a href="https://github.com/mrirecon/image-priors" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">Code</a> </div> <div class="badges"> </div> </div> </div> </li></ol> <h2 class="bibliography">2022</h2> <ol class="bibliography"><li> <div class="row"> <div class="col-sm-2 abbr"> <abbr class="badge">ISMRM</abbr><br> <span class="badge"><span style="color:rgb(85, 151, 113)">Poster</span></span> </div> <div id="Luo__2022a" class="col-sm-8"> <div class="title">All you need are DICOM images</div> <div class="author"> <em>Guanxiong Luo</em>,Â Moritz Blumenthal,Â Xiaoqing Wang,Â andÂ Martin Uecker</div> <div class="periodical"> <em>In Proc. Intl. Soc. Mag. Reson. Med.</em>, Aug 2022 </div> <div class="periodical"> </div> <div class="links"> <a href="/assets/pdf/all_dicom.pdf" class="btn btn-sm z-depth-0" role="button">PDF</a> </div> <div class="badges"> </div> </div> </div> </li></ol> <h2 class="bibliography">2021</h2> <ol class="bibliography"> <li> <div class="row"> <div class="col-sm-2 abbr"> <abbr class="badge">ISMRM</abbr><br> <span class="badge"><span style="color:rgb(85, 151, 113)">Oral</span></span> </div> <div id="Luo__2021_b" class="col-sm-8"> <div class="title">Joint estimation of coil sensitivities and image content using a deep image prior</div> <div class="author"> <em>Guanxiong Luo</em>,Â Xiaoqing Wang,Â Volkert Roeloffs,Â Zhengguo Tan,Â andÂ Martin Uecker</div> <div class="periodical"> <em>In Proc. Intl. Soc. Mag. Reson. Med.</em>, Aug 2021 </div> <div class="periodical"> </div> <div class="links"> <a href="https://github.com/mrirecon/image-priors/tree/main/scripts/recon" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">Code</a> <a href="https://index.mirasmart.com/ISMRM2021/PDFfiles/0280.html" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">Website</a> </div> <div class="badges"> </div> </div> </div> </li> <li> <div class="row"> <div class="col-sm-2 abbr"> <abbr class="badge">ISMRM</abbr><br> <span class="badge"><span style="color:rgb(85, 151, 113)">Poster</span></span> </div> <div id="Luo__2021_a" class="col-sm-8"> <div class="title">Using data-driven image priors for image reconstruction with BART</div> <div class="author"> <em>Guanxiong Luo</em>,Â Moritz Blumenthal,Â andÂ Martin Uecker</div> <div class="periodical"> <em>In Proc. Intl. Soc. Mag. Reson. Med.</em>, Aug 2021 </div> <div class="periodical"> </div> <div class="links"> <a href="/assets/pdf/bart_tf.pdf" class="btn btn-sm z-depth-0" role="button">PDF</a> <a href="https://colab.research.google.com/github/mrirecon/bart-workshop/blob/master/ismrm2021/bart_tensorflow/bart_tf.ipynb" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">Code</a> </div> <div class="badges"> </div> </div> </div> </li> </ol> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> Â© Copyright 2023 Guanxiong Jason Luo. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js"></script> <script defer src="/assets/js/common.js"></script> <script defer src="/assets/js/copy_code.js" type="text/javascript"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>