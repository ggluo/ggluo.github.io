<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Autogressive image diffusion: generation of image sequences and application in MRI reconstruction | Guanxiong Luo</title> <meta name="author" content="Guanxiong Luo"> <meta name="description" content="autoregressive, diffusion models, image sequences, inverse problem, MRI reconstruction"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%90%86&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://ggluo.github.io/projects/autoregressive-diffusion"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">GuanxiongÂ Luo</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/index.html">Blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Autogressive image diffusion: generation of image sequences and application in MRI reconstruction</h1> <p class="post-description">autoregressive, diffusion models, image sequences, inverse problem, MRI reconstruction</p> </header> <article> <div style="float: right; margin-left: 1rem; margin-bottom: 0rem"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 1000px)" srcset="https://arxiv.org/html/2405.14327v2/x1-1000.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1200px)" srcset="https://arxiv.org/html/2405.14327v2/x1-1200.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="https://arxiv.org/html/2405.14327v2/x1-1400.webp"></source> <img src="https://arxiv.org/html/2405.14327v2/x1.png" class="img-fluid rounded z-depth-1" width="400" height="auto" title="overview" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption_post"> Figure 1. Overview of the proposed method. </div> </div> <p><strong><code class="language-plaintext highlighter-rouge">Abstract</code></strong> Magnetic resonance imaging (MRI) is a widely used non-invasive imaging modality. However, a persistent challenge lies in balancing image quality with imaging speed. This trade-off is primarily constrained by k-space measurements, which traverse specific trajectories in the spatial Fourier domain (k-space). These measurements are often undersampled to shorten acquisition times, resulting in image artifacts and compromised quality. Generative models learn image distributions and can be used to reconstruct high-quality images from undersampled k-space data. In this work, we present the autoregressive image diffusion (AID) model for image sequences and use it to sample the posterior for accelerated MRI reconstruction. The algorithm incorporates both undersampled k-space and pre-existing information. Models trained with fastMRI dataset are evaluated comprehensively. The results show that the AID model can robustly generate sequentially coherent image sequences. In 3D and dynamic MRI, the AID can outperform the standard diffusion model and reduce hallucinations, due to the learned inter-image dependencies.</p> <p><strong><code class="language-plaintext highlighter-rouge">TLDR</code></strong> In 3D and dynamic MRI, the AID can outperform the standard diffusion model and reduce hallucinations, due to the learned inter-image dependencies.</p> <p>To test different aspects of the autoregressive diffusion models, we generate the sequence of images using the following two approaches.</p> <p><strong>Retrospective and prospective (warm start) sampling</strong>: This method generates a new sequence of images \(\{\tilde{x}_1, \ldots, \tilde{x}_{N-1}\}\) based on the given sequence \(\{x_0, \ldots, x_N\}\). \(\tilde{x}_n\) is sampled using the reverse process given \(\{x_0, \ldots, x_{n-1}\}\).</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 1000px)" srcset="https://arxiv.org/html/2405.14327v2/x2-1000.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1200px)" srcset="https://arxiv.org/html/2405.14327v2/x2-1200.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="https://arxiv.org/html/2405.14327v2/x2-1400.webp"></source> <img src="https://arxiv.org/html/2405.14327v2/x2.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="MMSE vs MAP" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 1000px)" srcset="https://arxiv.org/html/2405.14327v2/x3-1000.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1200px)" srcset="https://arxiv.org/html/2405.14327v2/x3-1200.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="https://arxiv.org/html/2405.14327v2/x3-1400.webp"></source> <img src="https://arxiv.org/html/2405.14327v2/x3.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="MMSE vs MAP" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption_post" style="margin-bottom: 1.15rem"> Top: A sequence of images from dataset is shown in the first row and is used as conditioning to generate retrospective samples that are shown in the second row. Bottom: With the given sequence in the top as a warm start, prospective samples extend it and are shown. </div> </div> <p><strong>Prospective sampling (cold start)</strong>: A fixed-length sliding window is initialized with the given sequence \(x_{&lt;n}=\{x_0, \ldots, x_{N-1}\}\). \(x_N\) is generated using reverse process with the current window as conditioning. Subsequently, the window is updated by adding the newly generated \(x_N\) and removing the earliest image \(x_0\). This autoregressive sampling process is repeated until the stop condition is met. We refer to this process as a warm start. In a cold start, the window is initialized with zeros, and each element \(x_n\) in it is updated with newly generated images from the beginning to the end, after which the generation is warmed up.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 1000px)" srcset="https://arxiv.org/html/2405.14327v2/x4-1000.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1200px)" srcset="https://arxiv.org/html/2405.14327v2/x4-1200.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="https://arxiv.org/html/2405.14327v2/x4-1400.webp"></source> <img src="https://arxiv.org/html/2405.14327v2/x4.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="MMSE vs MAP" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p><strong>MRI reconstruction</strong>: For the visual impression of the improvement by the AID model in reconstruction, we show the reconstructed images in the following figure and more of them in Appendix. The images reconstructed using AID are more visually similar to the reference images than using Guide, even which also provides aliased-free images. Furthermore, it is worth noting that more visually notable hallucinations were introduced by the Guide model than the AID model, which means AID is more trustworthy.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 1000px)" srcset="https://arxiv.org/html/2405.14327v2/x9-1000.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1200px)" srcset="https://arxiv.org/html/2405.14327v2/x9-1200.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="https://arxiv.org/html/2405.14327v2/x9-1400.webp"></source> <img src="https://arxiv.org/html/2405.14327v2/x9.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="MMSE vs MAP" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption_post" style="margin-bottom: 1.15rem"> E: equispaced, R: random. The red lines are autocalibration signal (ACS) and equispaced mask is not shown. Zero-filled images are computed by inverse Fourier transform of the zero-filled k-space data. The hallucinations are pointed with red arrows. </div> </div> <p><strong><code class="language-plaintext highlighter-rouge">Conclusion</code></strong> The proposed autoregressive image diffusion model offers an approach to generating image sequences, with significant potential as a trustworthy prior in accelerated MRI reconstruction. In various experiments, it outperforms the standard diffusion model in terms of both image quality and robustness by taking the advantage of the prior information on inter-image dependencies.</p> </article> <h2>References</h2> <div class="publications"> <h2 class="bibliography">2024</h2> <ol class="bibliography"><li> <div class="row"> <div class="col-sm-2 abbr"><abbr class="badge">NeurIPS</abbr></div> <div id="luo2024autoregressive" class="col-sm-8"> <div class="title">Autoregressive Image Diffusion: Generation of Image Sequence and Application in MRI</div> <div class="author"> <em>Guanxiong Luo</em>,Â Shoujin Huang,Â andÂ Martin Uecker</div> <div class="periodical"> <em>In NeurIPS 2024: 37th Conference on Neural Information Processing Systems</em>, Dec 2024 </div> <div class="periodical"> </div> <div class="links"> <a href="https://arxiv.org/abs/2405.14327" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">Website</a> </div> <div class="badges"> </div> </div> </div> </li></ol> <h2 class="bibliography">2023</h2> <ol class="bibliography"><li> <div class="row"> <div class="col-sm-2 abbr"> <abbr class="badge">MRM</abbr><br> <span class="badge"><span style="color:rgb(85, 151, 113)">Oral</span></span> </div> <div id="Luo_Magn.Reson.Med._2023" class="col-sm-8"> <div class="title">Bayesian MRI reconstruction with joint uncertainty estimation using diffusion models</div> <div class="author"> <em>Guanxiong Luo</em>,Â Moritz Blumenthal,Â Martin Heide,Â andÂ Martin Uecker</div> <div class="periodical"> <em>Magn. Reson. Med.</em>, Dec 2023 </div> <div class="periodical"> </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a href="/assets/pdf/Luo_Magn.Reson.Med._2023.pdf" class="btn btn-sm z-depth-0" role="button">PDF</a> <a href="https://github.com/mrirecon/spreco" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">Code</a> </div> <div class="badges"> </div> <div class="abstract hidden"> <p>Purpose We introduce a framework that enables efficient sampling from learned probability distributions for MRI reconstruction. Method Samples are drawn from the posterior distribution given the measured k-space using the Markov chain Monte Carlo (MCMC) method, different from conventional deep learning-based MRI reconstruction techniques. In addition to the maximum a posteriori estimate for the image, which can be obtained by maximizing the log-likelihood indirectly or directly, the minimum mean square error estimate and uncertainty maps can also be computed from those drawn samples. The data-driven Markov chains are constructed with the score-based generative model learned from a given image database and are independent of the forward operator that is used to model the k-space measurement. Results We numerically investigate the framework from these perspectives: (1) the interpretation of the uncertainty of the image reconstructed from undersampled k-space; (2) the effect of the number of noise scales used to train the generative models; (3) using a burn-in phase in MCMC sampling to reduce computation; (4) the comparison to conventional L1-wavelet regularized reconstruction; (5) the transferability of learned information; and (6) the comparison to fastMRI challenge. Conclusion A framework is described that connects the diffusion process and advanced generative models with Markov chains. We demonstrate its flexibility in terms of contrasts and sampling patterns using advanced generative priors and the benefits of also quantifying the uncertainty for every pixel.</p> </div> </div> </div> </li></ol> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> Â© Copyright 2025 Guanxiong Luo. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js"></script> <script defer src="/assets/js/common.js"></script> <script defer src="/assets/js/copy_code.js" type="text/javascript"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>