<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>MRI reconstruction using deep Bayesian estimation | Guanxiong Jason Luo</title> <meta name="author" content="Guanxiong Jason Luo"> <meta name="description" content="generative model, PixelCNN, Bayesian estimation, MR image reconstruction, optimization"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://ggluo.github.io/projects/4_project/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Guanxiong Luo</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">MRI reconstruction using deep Bayesian estimation</h1> <p class="post-description">generative model, PixelCNN, Bayesian estimation, MR image reconstruction, optimization</p> </header> <article> <div style="float: right; margin-left: 1rem; margin-bottom: 0rem"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/projects/map/overview-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1200px)" srcset="/assets/img/projects/map/overview-1200.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/projects/map/overview-1400.webp"></source> <img src="/assets/img/projects/map/overview.png" class="img-fluid rounded z-depth-1" width="350" height="auto" title="overview" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption_post"> Figure 1. Overview of the proposed method. </div> </div> <p><strong><code class="language-plaintext highlighter-rouge">Abstract</code></strong> We developed a deep learning-based Bayesian estimation for MRI reconstruction. The image reconstruction from incomplete k-space measurement was obtained by maximizing the posterior probability (MAP). The autoregressive generative model <a href="https://arxiv.org/abs/1701.05517" rel="external nofollow noopener" target="_blank">PixelCNN</a> was utilized as the image prior and the k-space data fidelity was enforced by using an equality constraint. The stochastic back-propagation was utilized to calculate the descent gradient in the process of maximum a posterior, and a projected sub-gradient method was used to impose the equality constraint. In contrast to the other deep learning reconstruction methods, the proposed one used the likelihood of prior as the training loss and the objective function in reconstruction to improve the image quality.</p> <p><strong><code class="language-plaintext highlighter-rouge">Method</code></strong> There two stages in our approach. The first is to learn prior information from an existing dataset using PixelCNN, and the second is to maximize the posterior using the sub-gradient projection method as illustrated in Figure 2.</p> <p>With Bayes theorem, one could write the posterior as a product of likelihood and prior: \begin{equation} f(x|y) = \frac{f(y\mid x)g(x)}{f(y)} \propto f(y\mid x )\,g(x ) \label{eq:1} \nonumber \end{equation} where \(f(y\mid x)\) is probability of the measured k-space data \(y\in \mathbb{C}^M\) for a given image \(x\in \mathbb{C}^N\), \(N\) is the number of pixels and \(M\) is the number of measured data points. \(g(x)\) is the prior model that estimates the distribution of MR images. In order to avoid the confusion with the likelihood occurs in modelling the prior, \(f(y\mid x)\) is referred to as k-space likelihood model. The image reconstruction is achieved by exploring the posterior \(f(x\mid y)\) with an appropriate estimator. The maximum a posterior estimation could provide the reconstructed image \(\hat{x}\) that is given by: \begin{equation} {\hat {x }}_{\mathrm {MAP} }(y)={\underset {x}{\operatorname {arg\,max} }}\ f(x \mid y)={\underset {x}{\operatorname {arg\,max} }}\ f(y\mid x)\,g(x)\nonumber \label{eq:2} \end{equation} In this way, the reconstruction problem is recast as posterior probability calculations.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/projects/map/algo-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1200px)" srcset="/assets/img/projects/map/algo-1200.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/projects/map/algo-1400.webp"></source> <img src="/assets/img/projects/map/algo.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="overview" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption_post" style="margin-bottom: 1.15rem"> Figure 2. The proposed reconstruction algorithm. </div> </div> <div style="float: right; margin-left: 1rem; margin-bottom: 0rem"> <figure> <video src="/assets/img/projects/map/map.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" autoplay="" controls=""></video> </figure> <div class="caption_post" style="margin-bottom: 1rem"> Figure 3. Visualization of the iterations. </div> </div> <p>Specifically, we reconstructed images with 256\(\times\)256 matrix size, using the prior model \(g(x)\) that was trained with 128\(\times\)128 images. To reconcile this mismatch, we split one 256\(\times\)256 image into four 128\(\times\)128 patches for applying the prior model. After updating \({s}^{(k+1)}\), four patches for one image were merged to form an image with the original size of 256\(\times\)256. Then the merged image was projected onto \(\{x\mid y = \mathcal{A} x \ + \ \varepsilon\}\). Furthermore, the random shift along phase encoding direction was applied to mitigate the stitching line in-between patches. <code class="language-plaintext highlighter-rouge">Figure 3</code> displays the evolution of image during the process of reconstruction.</p> <p><strong><code class="language-plaintext highlighter-rouge">Conclusion</code></strong> The Bayesian estimation significantly improved the reconstruction performance, compared with the conventional L\(^1\)-sparsity prior in compressed sensing reconstruction tasks. More importantly, the learnt prior knowledge is generic to many MRI reconstruction scenarios when changing sampling patterns, coils and so on.</p> </article> <h2>References</h2> <div class="publications"> <h2 class="bibliography">2020</h2> <ol class="bibliography"><li> <div class="row"> <div class="col-sm-2 abbr"> <abbr class="badge">MRM</abbr><br> <span class="badge"><span style="color:rgb(85, 151, 113)">oral</span></span> </div> <div id="Luo_Magn.Reson.Med._2020" class="col-sm-8"> <div class="title">MRI reconstruction using deep Bayesian estimation</div> <div class="author"> <em>Guanxiong Luo</em>, Na Zhao, Wenhao Jiang, Edward S. Hui, and Peng Cao</div> <div class="periodical"> <em>Magn. Reson. Med.</em>, Apr 2020 </div> <div class="periodical"> </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a href="/assets/pdf/Luo_Magn.Reson.Med._2020.pdf" class="btn btn-sm z-depth-0" role="button">PDF</a> <a href="https://github.com/mrirecon/spreco" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">Code</a> </div> <div class="badges"> </div> <div class="abstract hidden"> <p>Purpose To develop a deep learning-based Bayesian estimation for MRI reconstruction. Methods We modeled the MRI reconstruction problem with Bayes’s theorem, following the recently proposed PixelCNN++ method. The image reconstruction from incomplete k-space measurement was obtained by maximizing the posterior possibility. A generative network was utilized as the image prior, which was computationally tractable, and the k-space data fidelity was enforced by using an equality constraint. The stochastic backpropagation was utilized to calculate the descent gradient in the process of maximum a posterior, and a projected subgradient method was used to impose the equality constraint. In contrast to the other deep learning reconstruction methods, the proposed one used the likelihood of prior as the training loss and the objective function in reconstruction to improve the image quality. Results The proposed method showed an improved performance in preserving image details and reducing aliasing artifacts, compared with GRAPPA, -ESPRiT, model-based deep learning architecture for inverse problems (MODL), and variational network (VN), last two were state-of-the-art deep learning reconstruction methods. The proposed method generally achieved more than 3 dB peak signal-to-noise ratio improvement for compressed sensing and parallel imaging reconstructions compared with the other methods. Conclusions The Bayesian estimation significantly improved the reconstruction performance, compared with the conventional L1-sparsity prior in compressed sensing reconstruction tasks. More importantly, the proposed reconstruction framework can be generalized for most MRI reconstruction scenarios.</p> </div> </div> </div> </li></ol> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Guanxiong Jason Luo. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js"></script> <script defer src="/assets/js/common.js"></script> <script defer src="/assets/js/copy_code.js" type="text/javascript"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>